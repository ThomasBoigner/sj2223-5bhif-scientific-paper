= Protection against Exploits

Spring Security provides a lot of ways to protect you against exploits here is a short list:

== Password hashing

An easy way to protect passwords from data leaks is to hash them before we store them. This will make them unreadable for everyone. That means we have to hash the input of the users, to make it match the saved password, before checking if the passwords match.

To use a Password encoder simply add a password encoder bean:
[source, java]
----
include::../../main/java/at/spengergasse/sj22235bhifpos1scientificpaper/config/SecurityConfig.java[tags=passwordEncoder]
----

After we have registered an encoder bean we can inject it into any class and call the passwordencoder.encode() method. +
Here is a list of the all the available encoders:

* BCryptPasswordEncoder
* Argon2PasswordEncoder
* Pbkdf2PasswordEncoder
* SCryptPasswordEncoder

== Redirect to Https

We can force our users to use https instead of http by adding the following to your SecurityFilterChain:

[source, java]
----
include::../../main/java/at/spengergasse/sj22235bhifpos1scientificpaper/config/SecurityConfig.java[tags=https]
----

If we want to use https we need to generate a key and add a keystore. We can do this by running the following command:

Make sure to change the storepass and keypass to something else before you run the command.

----
keytool -genkey -alias tomcat -keyalg RSA -storepass changeit -keypass changeit -dname 'CN=tomcat'
----

Then we have to add the route together with the keypass to our application.properties:

----
server.ssl.key-store=C:/Users/YourUsername/.keystore
server.ssl.key-store-password=changeit
server.ssl.keyStoreType=PKCS12
server.ssl.keyAlias=tomcat
----

now we should be able to use https to access our application.

== Other protection measurements and their default settings

=== CSRF protection
Protection against https://en.wikipedia.org/wiki/Cross-site_request_forgery[cross-site request forgery] is enabled by default and can be configured with the http.csrf() method in the SecurityFilterChain.

=== Security HTTP Response headers
There are multiple Security Headers you can enable by configuring http.headers() in the SecurityFilterChain.

These headers are:

* Cache Control
** enabled by default
* Content Type Options
** enabled by default
* HTTP Strict Transport Security (HSTS)
** enabled by default
* HTTP Public Key Pinning (HPKP)
** not enabled by default, not recommended anymore
* X-Frame-Options
** enabled by default
* X-XSS-Protection
** enabled by default
* Content Security Policy (CSP)
** not enabled by default
* Referrer Policy
** not enabled by default
* Feature Policy
** not enabled by default
* Permissions Policy
** not enabled by default
* Clear Site Data
** not enabled by default

Explaining all of these headers is out of the scope of this technical paper, but you can find a detailed explanation of them https://docs.spring.io/spring-security/reference/features/exploits/headers.html[here]